<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 API Calls, Functions, and Iterations | My Bookdown</title>
  <meta name="description" content="This is an example of using the bookdown package for my final project. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 API Calls, Functions, and Iterations | My Bookdown" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an example of using the bookdown package for my final project. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 API Calls, Functions, and Iterations | My Bookdown" />
  
  <meta name="twitter:description" content="This is an example of using the bookdown package for my final project. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Spencer Zigler Soliz" />


<meta name="date" content="2024-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="data-wrangling-and-visualization.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>My Introduction</a></li>
<li class="chapter" data-level="1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html"><i class="fa fa-check"></i><b>1</b> API Calls, Functions, and Iterations</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#lesson-objectives"><i class="fa fa-check"></i><b>1.0.1</b> Lesson Objectives</a></li>
<li class="chapter" data-level="1.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#apis"><i class="fa fa-check"></i><b>1.1</b> APIs</a></li>
<li class="chapter" data-level="1.2" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#nps-visitation-data"><i class="fa fa-check"></i><b>1.2</b> NPS Visitation Data</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-1"><i class="fa fa-check"></i><b>1.2.1</b> Exercise #1</a></li>
<li class="chapter" data-level="1.2.2" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-2"><i class="fa fa-check"></i><b>1.2.2</b> Exercise #2</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#functions"><i class="fa fa-check"></i><b>1.3</b> Functions</a></li>
<li class="chapter" data-level="1.4" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#functionize-api-pulls"><i class="fa fa-check"></i><b>1.4</b> Functionize API Pulls</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-3"><i class="fa fa-check"></i><b>1.4.1</b> Exercise #3</a></li>
<li class="chapter" data-level="1.4.2" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-4"><i class="fa fa-check"></i><b>1.4.2</b> Exercise #4</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#function-defaults"><i class="fa fa-check"></i><b>1.5</b> Function Defaults</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-5"><i class="fa fa-check"></i><b>1.5.1</b> Exercise #5</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#iterations"><i class="fa fa-check"></i><b>1.6</b> Iterations</a></li>
<li class="chapter" data-level="1.7" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#for-loops"><i class="fa fa-check"></i><b>1.7</b> For loops</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-6"><i class="fa fa-check"></i><b>1.7.1</b> Exercise #6</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#mapping"><i class="fa fa-check"></i><b>1.8</b> Mapping</a>
<ul>
<li class="chapter" data-level="1.8.1" data-path="api-calls-functions-and-iterations.html"><a href="api-calls-functions-and-iterations.html#exercise-7"><i class="fa fa-check"></i><b>1.8.1</b> Exercise #7</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html"><i class="fa fa-check"></i><b>2</b> Data Wrangling and Visualization</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#lesson-objectives-1"><i class="fa fa-check"></i><b>2.0.1</b> Lesson Objectives</a></li>
<li class="chapter" data-level="2.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#pulling-in-necessary-packages-and-data-sets"><i class="fa fa-check"></i><b>2.1</b> Pulling in necessary packages and data sets</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exercise-1-1"><i class="fa fa-check"></i><b>2.1.1</b> Exercise #1</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exploring-our-data"><i class="fa fa-check"></i><b>2.2</b> Exploring our data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exercise-2-1"><i class="fa fa-check"></i><b>2.2.1</b> Exercise #2</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#pivoting"><i class="fa fa-check"></i><b>2.3</b> Pivoting</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exercise-3-1"><i class="fa fa-check"></i><b>2.3.1</b> Exercise #3</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#joining"><i class="fa fa-check"></i><b>2.4</b> Joining</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exercise-4-1"><i class="fa fa-check"></i><b>2.4.1</b> Exercise #4</a></li>
<li class="chapter" data-level="2.4.2" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exercise-5-1"><i class="fa fa-check"></i><b>2.4.2</b> Exercise #5</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#spatial-data-formats"><i class="fa fa-check"></i><b>2.5</b> 1. Spatial Data Formats</a></li>
<li class="chapter" data-level="2.6" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#import-and-manipulate-spatial-data"><i class="fa fa-check"></i><b>2.6</b> 2. Import and manipulate spatial data</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#vector-data"><i class="fa fa-check"></i><b>2.6.1</b> 2.1 Vector Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#tigris"><i class="fa fa-check"></i><b>2.6.2</b> <code>tigris</code></a></li>
<li class="chapter" data-level="2.6.3" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#polygons"><i class="fa fa-check"></i><b>2.6.3</b> <strong>Polygons</strong></a></li>
<li class="chapter" data-level="2.6.4" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#lines"><i class="fa fa-check"></i><b>2.6.4</b> <strong>Lines</strong></a></li>
<li class="chapter" data-level="2.6.5" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#tmap"><i class="fa fa-check"></i><b>2.6.5</b> <code>tmap</code></a></li>
<li class="chapter" data-level="2.6.6" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#sf"><i class="fa fa-check"></i><b>2.6.6</b> <code>sf</code></a></li>
<li class="chapter" data-level="2.6.7" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#points"><i class="fa fa-check"></i><b>2.6.7</b> Points</a></li>
<li class="chapter" data-level="2.6.8" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#coordinate-reference-systems"><i class="fa fa-check"></i><b>2.6.8</b> Coordinate Reference Systems</a></li>
<li class="chapter" data-level="2.6.9" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#raster-data"><i class="fa fa-check"></i><b>2.6.9</b> 2.2 Raster Data</a></li>
<li class="chapter" data-level="2.6.10" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#elevatr"><i class="fa fa-check"></i><b>2.6.10</b> <code>elevatr</code></a></li>
<li class="chapter" data-level="2.6.11" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#terra"><i class="fa fa-check"></i><b>2.6.11</b> <code>terra</code></a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#reading-and-writing-spatial-data"><i class="fa fa-check"></i><b>2.7</b> 3. Reading and Writing Spatial Data</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#writing-spatial-data"><i class="fa fa-check"></i><b>2.7.1</b> 3.1 Writing spatial data</a></li>
<li class="chapter" data-level="2.7.2" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#rdata-files"><i class="fa fa-check"></i><b>2.7.2</b> 3.2 .RData Files</a></li>
<li class="chapter" data-level="2.7.3" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#reading-spatial-data"><i class="fa fa-check"></i><b>2.7.3</b> 3.3 Reading Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="data-wrangling-and-visualization.html"><a href="data-wrangling-and-visualization.html#exercises"><i class="fa fa-check"></i><b>2.8</b> 4. Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Spatial Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#load-in-spatial-data"><i class="fa fa-check"></i><b>3.1</b> Load in spatial data</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#bonus-lesson"><i class="fa fa-check"></i><b>3.1.1</b> Bonus Lesson</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#distance-calculations"><i class="fa fa-check"></i><b>3.2</b> Distance Calculations</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#exercise-1-2"><i class="fa fa-check"></i><b>3.2.1</b> Exercise #1</a></li>
<li class="chapter" data-level="3.2.2" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#exercise-2-2"><i class="fa fa-check"></i><b>3.2.2</b> Exercise #2</a></li>
<li class="chapter" data-level="3.2.3" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#exercise-3-2"><i class="fa fa-check"></i><b>3.2.3</b> Exercise #3</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#buffers"><i class="fa fa-check"></i><b>3.3</b> Buffers</a></li>
<li class="chapter" data-level="3.4" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#spatial-intersect"><i class="fa fa-check"></i><b>3.4</b> Spatial Intersect</a></li>
<li class="chapter" data-level="3.5" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#raster-reclassification"><i class="fa fa-check"></i><b>3.5</b> Raster Reclassification</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#exercise-4-2"><i class="fa fa-check"></i><b>3.5.1</b> Exercise 4</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#extraction-statistics"><i class="fa fa-check"></i><b>3.6</b> Extraction Statistics</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#exercise-5-2"><i class="fa fa-check"></i><b>3.6.1</b> Exercise 5</a></li>
<li class="chapter" data-level="3.6.2" data-path="spatial-data-analysis.html"><a href="spatial-data-analysis.html#exercise-6-1"><i class="fa fa-check"></i><b>3.6.2</b> Exercise 6</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">My Bookdown</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="api-calls-functions-and-iterations" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> API Calls, Functions, and Iterations<a href="api-calls-functions-and-iterations.html#api-calls-functions-and-iterations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="lesson-objectives" class="section level3 hasAnchor" number="1.0.1">
<h3><span class="header-section-number">1.0.1</span> Lesson Objectives<a href="api-calls-functions-and-iterations.html#lesson-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this lesson we will download data using an application programming interface (API), create our own functions, and iterate using <code>for</code> loops and <code>map()</code>. To fulfill these objectives we will be utilizing two park visitation data sets from the National Park Service (NPS): NPS-wide visitation data, and park unit-specific visitation data.</p>
<p>There are <strong>seven exercises</strong> in this lesson that must be completed.</p>
</div>
<div id="apis" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> APIs<a href="api-calls-functions-and-iterations.html#apis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An API is software that acts as an intermediary between an online data warehouse (or server) and its users (or clients). As data scientists, APIs provide us a way to request clean and nicely-formatted data that the server will then send to our local computers, all within our RStudio console! To work with APIs, we will need to use two new packages: {httr}, which allows us to communicate with the API’s server, and {jsonlite}, which allows us to work with one of the most common API data formats, JSON. Let’s go ahead and load in our packages for this lesson:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="api-calls-functions-and-iterations.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="api-calls-functions-and-iterations.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(httr) <span class="co"># new - need to install!</span></span>
<span id="cb1-3"><a href="api-calls-functions-and-iterations.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(jsonlite) <span class="co"># new - need to install!</span></span></code></pre></div>
</div>
<div id="nps-visitation-data" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> NPS Visitation Data<a href="api-calls-functions-and-iterations.html#nps-visitation-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This week, we will be exploring NPS visitor use data across the NPS system as a whole, and and across specific park units. Like many institutions, NPS has a server that stores all of this information (as well as many other things), and an API for users to be able to access it.</p>
<p>To utilize the NPS API in R, we first need to explore its <a href="https://irmaservices.nps.gov/">API’s data structure</a>. In almost every case, we use URLs to access specific data from APIs. To find the access URL for NPS visitation data, go to <a href="https://irmaservices.nps.gov/v3/rest/stats/help">Stats Rest API - Documentation</a> (though not very intuitive, the NPS API calls its visitation data set “Stats”). Listed there you will see that all data associated with the “Stats” data set can be accessed using the base URL <a href="https://irmaservices.nps.gov/v3/rest/stats" class="uri"><strong>https://irmaservices.nps.gov/v3/rest/stats</strong></a>. From there, you can tack on additional html text to access two different data sets: <strong>total/{year}</strong> and <strong>visitation</strong>.</p>
<p>For starters, let’s try accessing the <strong>total/{year}</strong>. This data set gives us total monthly visitation across all NPS park units, for a user-selected year:</p>
<p><a href="https://irmaservices.nps.gov/v3/rest/stats/total/%7BYEAR%7D" class="uri"><strong>https://irmaservices.nps.gov/v3/rest/stats/total/{YEAR}</strong></a></p>
<p>If you tried accessing that URL, you’ll have noticed it doesn’t take you anywhere. This is because the curly brackets {} signify locations in the URL that need to be updated by the user based on their specific needs. I’m curious about visitor use in my birth year, so let’s tweak the URL to access visitation data from 1992. In R, we can access this data using {httr}’s <code>GET()</code> function, replacing {YEAR} with 1992.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="api-calls-functions-and-iterations.html#cb2-1" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/1992&quot;</span>)</span>
<span id="cb2-2"><a href="api-calls-functions-and-iterations.html#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="api-calls-functions-and-iterations.html#cb2-3" tabindex="-1"></a><span class="fu">glimpse</span>(raw_data)</span></code></pre></div>
<pre><code>## List of 10
##  $ url        : chr &quot;https://irmaservices.nps.gov/v3/rest/stats/total/1992&quot;
##  $ status_code: int 200
##  $ headers    :List of 11
##   ..$ date                     : chr &quot;Fri, 13 Dec 2024 22:08:33 GMT&quot;
##   ..$ content-type             : chr &quot;application/json; charset=utf-8&quot;
##   ..$ content-length           : chr &quot;1420&quot;
##   ..$ connection               : chr &quot;keep-alive&quot;
##   ..$ cache-control            : chr &quot;private&quot;
##   ..$ server                   : chr &quot;Microsoft-IIS/10.0&quot;
##   ..$ set-cookie               : chr &quot;ASP.NET_SessionID=mx55qxsikfqjiwn0daiizcc1; path=/; secure; HttpOnly; SameSite=Lax&quot;
##   ..$ x-aspnet-version         : chr &quot;4.0.30319&quot;
##   ..$ frame-ancestors          : chr &quot;*.nps.gov&quot;
##   ..$ strict-transport-security: chr &quot;max-age=31536000; includeSubDomains&quot;
##   ..$ x-frame-options          : chr &quot;SAMEORIGIN&quot;
##   ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;insensitive&quot; &quot;list&quot;
##  $ all_headers:List of 1
##   ..$ :List of 3
##   .. ..$ status : int 200
##   .. ..$ version: chr &quot;HTTP/1.1&quot;
##   .. ..$ headers:List of 11
##   .. .. ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;insensitive&quot; &quot;list&quot;
##  $ cookies    :&#39;data.frame&#39;: 1 obs. of  7 variables:
##   ..$ domain    : chr &quot;#HttpOnly_irmaservices.nps.gov&quot;
##   ..$ flag      : logi FALSE
##   ..$ path      : chr &quot;/&quot;
##   ..$ secure    : logi TRUE
##   ..$ expiration: POSIXct[1:1], format: &quot;Inf&quot;
##   ..$ name      : chr &quot;ASP.NET_SessionID&quot;
##   ..$ value     : chr &quot;mx55qxsikfqjiwn0daiizcc1&quot;
##  $ content    : raw [1:1420] 5b 7b 22 4d ...
##  $ date       : POSIXct[1:1], format: &quot;2024-12-13 22:08:33&quot;
##  $ times      : Named num [1:6] 0 0.0174 0.0721 0.1374 0.2417 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;redirect&quot; &quot;namelookup&quot; &quot;connect&quot; &quot;pretransfer&quot; ...
##  $ request    :List of 7
##   ..$ method    : chr &quot;GET&quot;
##   ..$ url       : chr &quot;https://irmaservices.nps.gov/v3/rest/stats/total/1992&quot;
##   ..$ headers   : Named chr &quot;application/json, text/xml, application/xml, */*&quot;
##   .. ..- attr(*, &quot;names&quot;)= chr &quot;Accept&quot;
##   ..$ fields    : NULL
##   ..$ options   :List of 2
##   .. ..$ useragent: chr &quot;libcurl/8.3.0 r-curl/5.2.3 httr/1.4.7&quot;
##   .. ..$ httpget  : logi TRUE
##   ..$ auth_token: NULL
##   ..$ output    : list()
##   .. ..- attr(*, &quot;class&quot;)= chr [1:2] &quot;write_memory&quot; &quot;write_function&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;request&quot;
##  $ handle     :Class &#39;curl_handle&#39; &lt;externalptr&gt; 
##  - attr(*, &quot;class&quot;)= chr &quot;response&quot;</code></pre>
<p>Viewing the data set as-is, you can see it is not super human-readable. This is because data sent from APIs is typically packaged using JavaScript Object Notation (JSON).</p>
<p>To unpack the data, we will first need to use {httr}’s <code>content()</code> function. In this example, we want the data to be extracted as <em>text,</em> since this is a data table. Moreover, its encoding is listed as <em>UTF-8</em>. The encoding parameter can be found by opening our raw data set in our R console:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="api-calls-functions-and-iterations.html#cb4-1" tabindex="-1"></a>raw_data <span class="co"># lists &#39;UTF-8&#39;</span></span></code></pre></div>
<pre><code>## Response [https://irmaservices.nps.gov/v3/rest/stats/total/1992]
##   Date: 2024-12-13 22:08
##   Status: 200
##   Content-Type: application/json; charset=utf-8
##   Size: 1.42 kB</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="api-calls-functions-and-iterations.html#cb6-1" tabindex="-1"></a><span class="co"># convert content to text</span></span>
<span id="cb6-2"><a href="api-calls-functions-and-iterations.html#cb6-2" tabindex="-1"></a>unpacked_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">content</span>(raw_data, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) </span></code></pre></div>
<p>Second, we need to transform this string of text, which is still in JSON formatting, into a data frame using {jsonlite}’s <code>fromJSON()</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="api-calls-functions-and-iterations.html#cb7-1" tabindex="-1"></a><span class="co"># parse text from JSON to data frame</span></span>
<span id="cb7-2"><a href="api-calls-functions-and-iterations.html#cb7-2" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(unpacked_data)</span>
<span id="cb7-3"><a href="api-calls-functions-and-iterations.html#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="api-calls-functions-and-iterations.html#cb7-4" tabindex="-1"></a>final_data</span></code></pre></div>
<pre><code>##    Month NonRecreationVisitors RecreationVisitors UnitCode UnitName Year
## 1      1               6209285           10940618       NA       NA 1992
## 2      2               6010027           11931340       NA       NA 1992
## 3      3               6756902           15369139       NA       NA 1992
## 4      4               7255782           21458739       NA       NA 1992
## 5      5               7690763           26648530       NA       NA 1992
## 6      6               7593227           33284625       NA       NA 1992
## 7      7               8438755           41099305       NA       NA 1992
## 8      8               8056823           38625804       NA       NA 1992
## 9      9               7329755           26438266       NA       NA 1992
## 10    10               7105574           23616057       NA       NA 1992
## 11    11               6507805           14338165       NA       NA 1992
## 12    12               6702698           10943961       NA       NA 1992</code></pre>
<p>Hooray, you have now successfully pulled in an online data set using an API! 😁</p>
<p>(… also note, the <code>UnitCode</code> and <code>UnitName</code> columns are empty - this is because this is parkwide data and there is no unit code or unit name associated with the entire NPS system. Just a weird NPS data structure thing!)</p>
<div id="exercise-1" class="section level3 hasAnchor" number="1.2.1" style="color: maroon">
<h3><span class="header-section-number">1.2.1</span> Exercise #1<a href="api-calls-functions-and-iterations.html#exercise-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Using the code above as a starting point, pull in monthly NPS-wide visitation data for the years 1980, 1999, and 2018.</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="api-calls-functions-and-iterations.html#cb9-1" tabindex="-1"></a>nps_data_1980 <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/1980&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="api-calls-functions-and-iterations.html#cb9-2" tabindex="-1"></a>  httr<span class="sc">::</span><span class="fu">content</span>(<span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="api-calls-functions-and-iterations.html#cb9-3" tabindex="-1"></a>  jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>()</span>
<span id="cb9-4"><a href="api-calls-functions-and-iterations.html#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="api-calls-functions-and-iterations.html#cb9-5" tabindex="-1"></a>nps_data_1999 <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/1999&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="api-calls-functions-and-iterations.html#cb9-6" tabindex="-1"></a>  httr<span class="sc">::</span><span class="fu">content</span>(<span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="api-calls-functions-and-iterations.html#cb9-7" tabindex="-1"></a>  jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>()</span>
<span id="cb9-8"><a href="api-calls-functions-and-iterations.html#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="api-calls-functions-and-iterations.html#cb9-9" tabindex="-1"></a>nps_data_2018 <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/2018&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-10"><a href="api-calls-functions-and-iterations.html#cb9-10" tabindex="-1"></a>  httr<span class="sc">::</span><span class="fu">content</span>(<span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="api-calls-functions-and-iterations.html#cb9-11" tabindex="-1"></a>  jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>()</span></code></pre></div>
</div>
<div id="exercise-2" class="section level3 hasAnchor" number="1.2.2" style="color: maroon">
<h3><span class="header-section-number">1.2.2</span> Exercise #2<a href="api-calls-functions-and-iterations.html#exercise-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Now, let’s explore the second NPS visitation data set, <a href="https://irmaservices.nps.gov/v3/rest/stats/help/operations/FetchVisitation">visitation</a>. This call pulls in monthly data for a specific park, across a specific time frame. Use your new API skills to pull in visitation data for Rocky Mountain National Park from 2010 through 2021, based on the API’s URL template. The unit code for Rocky Mountain National Park is ROMO. (Hint: an API URL can have multiple sections that need to be updated by the user; this one requires the starting month and year, the ending month and year, and the park unit of interest.)</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="api-calls-functions-and-iterations.html#cb10-1" tabindex="-1"></a>rmnp_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(</span>
<span id="cb10-2"><a href="api-calls-functions-and-iterations.html#cb10-2" tabindex="-1"></a>  <span class="st">&#39;https://irmaservices.nps.gov/v3/rest/stats/visitation?unitCodes=ROMO&amp;startMonth=1&amp;startYear=2010&amp;endMonth=12&amp;endYear=2021&#39;</span></span>
<span id="cb10-3"><a href="api-calls-functions-and-iterations.html#cb10-3" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-4"><a href="api-calls-functions-and-iterations.html#cb10-4" tabindex="-1"></a>  httr<span class="sc">::</span><span class="fu">content</span>(<span class="at">as =</span> <span class="st">&#39;text&#39;</span>, <span class="at">encoding =</span> <span class="st">&#39;UTF-8&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="api-calls-functions-and-iterations.html#cb10-5" tabindex="-1"></a>  jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>()</span></code></pre></div>
</div>
</div>
<div id="functions" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Functions<a href="api-calls-functions-and-iterations.html#functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may find yourself thinking, <em>“Wow, exercise 1 was overkill!”</em> Indeed, you had to run several lines of code that were nearly identical to what was shown upstream; the only thing you needed to change from one year to the next was the year itself. This sort of redundant coding is not good coding practice. Instead of copying and pasting many coding steps over and over again and tweaking just a tiny portion of it, we can write <em>functions</em> that combine many coding steps into just one command. The benefits of reducing redundant code in this way are threefold. As Grolemund &amp; Wickham describe in their book, <a href="https://r4ds.had.co.nz/"><em>R for Data Science</em></a>:</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>It’s easier to see the intent of your code, because your eyes are drawn to what’s different, not what stays the same.</li>
<li>It’s easier to respond to changes in requirements. As your needs change, you only need to make changes in one place, rather than remembering to change every place that you copied-and-pasted the code.</li>
<li>You’re likely to have fewer bugs because each line of code is used in more places.</li>
</ol>
</blockquote>
<p><em>Functions</em> provide the option of changing just a minor part of the code base from one run to the next. Think of the <code>GET()</code> function in {httr}: it is a function that has code under-the-hood so that it isn’t necessary to write out the raw code each time we use it. Instead, we call out the function’s name (<code>GET()</code>), and the necessary argument within that function that tweaks the code to fit it to our needs (<code>url = "&lt;SOME_URL_WE_CHOOSE&gt;"</code>).</p>
</div>
<div id="functionize-api-pulls" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Functionize API Pulls<a href="api-calls-functions-and-iterations.html#functionize-api-pulls" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s try making a function called <code>parkwide_visitation()</code> that pulls in NPS-wide visitation data for a year of choice. To develop a function requires specific formatting:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="api-calls-functions-and-iterations.html#cb11-1" tabindex="-1"></a><span class="sc">&lt;</span>NAME<span class="sc">&gt;</span> <span class="er">&lt;</span><span class="sc">-</span> <span class="cf">function</span>(<span class="sc">&lt;</span>ARGUMENTS<span class="sc">&gt;</span>){</span>
<span id="cb11-2"><a href="api-calls-functions-and-iterations.html#cb11-2" tabindex="-1"></a>  </span>
<span id="cb11-3"><a href="api-calls-functions-and-iterations.html#cb11-3" tabindex="-1"></a>  <span class="sc">&lt;</span>ACTIONS<span class="sc">&gt;</span></span>
<span id="cb11-4"><a href="api-calls-functions-and-iterations.html#cb11-4" tabindex="-1"></a>  </span>
<span id="cb11-5"><a href="api-calls-functions-and-iterations.html#cb11-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="sc">&lt;</span>OUTPUT<span class="sc">&gt;</span>)</span>
<span id="cb11-6"><a href="api-calls-functions-and-iterations.html#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="api-calls-functions-and-iterations.html#cb11-7" tabindex="-1"></a>  }</span></code></pre></div>
<p>… where NAME is what we want to name the function; ARGUMENTS are the variables in the code that get “tweaked”; ACTIONS are the lines of code we want the function to perform (which includes our ARGUMENTS); and the OUTPUT is the object we want as the final outcome of running the function.</p>
<p>For <code>parkwide_visitation()</code>, we will use our upstream code as the basis for our function, but with a few minor yet extremely important tweaks:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="api-calls-functions-and-iterations.html#cb12-1" tabindex="-1"></a>parkwide_visitation <span class="ot">&lt;-</span> <span class="cf">function</span>(year){</span>
<span id="cb12-2"><a href="api-calls-functions-and-iterations.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="api-calls-functions-and-iterations.html#cb12-3" tabindex="-1"></a><span class="co"># pull in the data</span></span>
<span id="cb12-4"><a href="api-calls-functions-and-iterations.html#cb12-4" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> </span>
<span id="cb12-5"><a href="api-calls-functions-and-iterations.html#cb12-5" tabindex="-1"></a>                        <span class="co"># parse out year so that it can be chosen with the &quot;year&quot;</span></span>
<span id="cb12-6"><a href="api-calls-functions-and-iterations.html#cb12-6" tabindex="-1"></a>                        <span class="co"># argument, using paste0()</span></span>
<span id="cb12-7"><a href="api-calls-functions-and-iterations.html#cb12-7" tabindex="-1"></a>                        <span class="fu">paste0</span>(<span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/&quot;</span>, year))</span>
<span id="cb12-8"><a href="api-calls-functions-and-iterations.html#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="api-calls-functions-and-iterations.html#cb12-9" tabindex="-1"></a><span class="co"># convert content to text</span></span>
<span id="cb12-10"><a href="api-calls-functions-and-iterations.html#cb12-10" tabindex="-1"></a>extracted_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">content</span>(raw_data, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) </span>
<span id="cb12-11"><a href="api-calls-functions-and-iterations.html#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="api-calls-functions-and-iterations.html#cb12-12" tabindex="-1"></a><span class="co"># parse text from JSON to data frame</span></span>
<span id="cb12-13"><a href="api-calls-functions-and-iterations.html#cb12-13" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(extracted_data)</span>
<span id="cb12-14"><a href="api-calls-functions-and-iterations.html#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="api-calls-functions-and-iterations.html#cb12-15" tabindex="-1"></a><span class="fu">return</span>(final_data)</span>
<span id="cb12-16"><a href="api-calls-functions-and-iterations.html#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="api-calls-functions-and-iterations.html#cb12-17" tabindex="-1"></a>}</span></code></pre></div>
<p>In the above function, our first object, <code>raw_data</code>, now changes based on how we define our year argument. We accomplish this through <code>paste0()</code>, which takes listed objects, transforms them into characters (if they aren’t already), and concatenates them into a single character string. For example:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="api-calls-functions-and-iterations.html#cb13-1" tabindex="-1"></a>my_sentence <span class="ot">&lt;-</span> <span class="st">&quot;I need at least&quot;</span></span>
<span id="cb13-2"><a href="api-calls-functions-and-iterations.html#cb13-2" tabindex="-1"></a>my_other_sentence <span class="ot">&lt;-</span> <span class="st">&quot;pints of ice cream a day&quot;</span></span>
<span id="cb13-3"><a href="api-calls-functions-and-iterations.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="api-calls-functions-and-iterations.html#cb13-4" tabindex="-1"></a><span class="fu">paste0</span>(my_sentence, <span class="st">&quot; &quot;</span>, <span class="dv">08</span>, <span class="st">&quot; &quot;</span>, my_other_sentence, <span class="st">&quot;!&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;I need at least 8 pints of ice cream a day!&quot;</code></pre>
<p>So, if we make <code>year = 2021</code> in our <code>parkwide_visitation()</code> function, the year object becomes the number 2021, which makes the <code>paste0()</code> output “<a href="https://irmaservices.nps.gov/v3/rest/stats/total/2021" class="uri">https://irmaservices.nps.gov/v3/rest/stats/total/2021</a>”, which subsequently pulls data for 2021. In other words, we can now pull visitation data for any year with just one line of code!</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="api-calls-functions-and-iterations.html#cb15-1" tabindex="-1"></a>pull_2018 <span class="ot">&lt;-</span> <span class="fu">parkwide_visitation</span>(<span class="at">year =</span> <span class="dv">2018</span>)</span>
<span id="cb15-2"><a href="api-calls-functions-and-iterations.html#cb15-2" tabindex="-1"></a></span>
<span id="cb15-3"><a href="api-calls-functions-and-iterations.html#cb15-3" tabindex="-1"></a>pull_1980 <span class="ot">&lt;-</span> <span class="fu">parkwide_visitation</span>(<span class="at">year =</span> <span class="dv">1980</span>)</span>
<span id="cb15-4"><a href="api-calls-functions-and-iterations.html#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="api-calls-functions-and-iterations.html#cb15-5" tabindex="-1"></a>pull_1992 <span class="ot">&lt;-</span> <span class="fu">parkwide_visitation</span>(<span class="at">year =</span> <span class="dv">1992</span>)</span>
<span id="cb15-6"><a href="api-calls-functions-and-iterations.html#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="api-calls-functions-and-iterations.html#cb15-7" tabindex="-1"></a><span class="co"># ... and so on!</span></span></code></pre></div>
<div id="exercise-3" class="section level3 hasAnchor" number="1.4.1" style="color: maroon">
<h3><span class="header-section-number">1.4.1</span> Exercise #3<a href="api-calls-functions-and-iterations.html#exercise-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Create a function called <code>unit_visitation()</code> that pulls park-specific visitation data for any park, across any time frame. For a list of all park codes for testing the function, download <a href="https://www.nps.gov/aboutus/foia/upload/NPS-Unit-List.xlsx">this spreadsheet</a>. (Hint 1: functions can have multiple arguments. For this step, you will want arguments representing the start and end month and year, and park unit). Hint 2: Exercise 2 should be used as a starting point for making this function.)</strong></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="api-calls-functions-and-iterations.html#cb16-1" tabindex="-1"></a>unit_visitation <span class="ot">&lt;-</span> <span class="cf">function</span>(park_unit,</span>
<span id="cb16-2"><a href="api-calls-functions-and-iterations.html#cb16-2" tabindex="-1"></a>                            start_month,</span>
<span id="cb16-3"><a href="api-calls-functions-and-iterations.html#cb16-3" tabindex="-1"></a>                            start_year,</span>
<span id="cb16-4"><a href="api-calls-functions-and-iterations.html#cb16-4" tabindex="-1"></a>                            end_month,</span>
<span id="cb16-5"><a href="api-calls-functions-and-iterations.html#cb16-5" tabindex="-1"></a>                            end_year) {</span>
<span id="cb16-6"><a href="api-calls-functions-and-iterations.html#cb16-6" tabindex="-1"></a>  raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(</span>
<span id="cb16-7"><a href="api-calls-functions-and-iterations.html#cb16-7" tabindex="-1"></a>    <span class="at">url =</span> <span class="fu">paste0</span>(</span>
<span id="cb16-8"><a href="api-calls-functions-and-iterations.html#cb16-8" tabindex="-1"></a>      <span class="st">&#39;https://irmaservices.nps.gov/v3/rest/stats/visitation?unitCodes=&#39;</span>,</span>
<span id="cb16-9"><a href="api-calls-functions-and-iterations.html#cb16-9" tabindex="-1"></a>      park_unit,</span>
<span id="cb16-10"><a href="api-calls-functions-and-iterations.html#cb16-10" tabindex="-1"></a>      <span class="st">&#39;&amp;startMonth=&#39;</span>,</span>
<span id="cb16-11"><a href="api-calls-functions-and-iterations.html#cb16-11" tabindex="-1"></a>      start_month,</span>
<span id="cb16-12"><a href="api-calls-functions-and-iterations.html#cb16-12" tabindex="-1"></a>      <span class="st">&#39;&amp;startYear=&#39;</span>,</span>
<span id="cb16-13"><a href="api-calls-functions-and-iterations.html#cb16-13" tabindex="-1"></a>      start_year,</span>
<span id="cb16-14"><a href="api-calls-functions-and-iterations.html#cb16-14" tabindex="-1"></a>      <span class="st">&#39;&amp;endMonth=&#39;</span>,</span>
<span id="cb16-15"><a href="api-calls-functions-and-iterations.html#cb16-15" tabindex="-1"></a>      end_month,</span>
<span id="cb16-16"><a href="api-calls-functions-and-iterations.html#cb16-16" tabindex="-1"></a>      <span class="st">&#39;&amp;endYear=&#39;</span>,</span>
<span id="cb16-17"><a href="api-calls-functions-and-iterations.html#cb16-17" tabindex="-1"></a>      end_year</span>
<span id="cb16-18"><a href="api-calls-functions-and-iterations.html#cb16-18" tabindex="-1"></a>    )</span>
<span id="cb16-19"><a href="api-calls-functions-and-iterations.html#cb16-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-20"><a href="api-calls-functions-and-iterations.html#cb16-20" tabindex="-1"></a>    httr<span class="sc">::</span><span class="fu">content</span>(<span class="at">as =</span> <span class="st">&#39;text&#39;</span>, <span class="at">encoding =</span> <span class="st">&#39;UTF-8&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="api-calls-functions-and-iterations.html#cb16-21" tabindex="-1"></a>    jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>()</span>
<span id="cb16-22"><a href="api-calls-functions-and-iterations.html#cb16-22" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="exercise-4" class="section level3 hasAnchor" number="1.4.2" style="color: maroon">
<h3><span class="header-section-number">1.4.2</span> Exercise #4<a href="api-calls-functions-and-iterations.html#exercise-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Using <code>unit_visitation()</code>, pull in visitation data for Rocky Mountain National Park (ROMO), Everglades National Park (EVER), and Theodore Roosevelt National Park (THRO) from November 1992 through December 2023.</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="api-calls-functions-and-iterations.html#cb17-1" tabindex="-1"></a>pull_ROMO <span class="ot">&lt;-</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> <span class="st">&#39;ROMO&#39;</span>, <span class="at">start_month =</span> <span class="dv">11</span>, <span class="at">start_year =</span> <span class="dv">1992</span>, <span class="at">end_month =</span> <span class="dv">12</span>, <span class="at">end_year =</span> <span class="dv">2023</span>)</span>
<span id="cb17-2"><a href="api-calls-functions-and-iterations.html#cb17-2" tabindex="-1"></a>pull_EVER <span class="ot">&lt;-</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> <span class="st">&#39;EVER&#39;</span>, <span class="at">start_month =</span> <span class="dv">11</span>, <span class="at">start_year =</span> <span class="dv">1992</span>, <span class="at">end_month =</span> <span class="dv">12</span>, <span class="at">end_year =</span> <span class="dv">2023</span>)</span>
<span id="cb17-3"><a href="api-calls-functions-and-iterations.html#cb17-3" tabindex="-1"></a>pull_THRO <span class="ot">&lt;-</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> <span class="st">&#39;THRO&#39;</span>, <span class="at">start_month =</span> <span class="dv">11</span>, <span class="at">start_year =</span> <span class="dv">1992</span>, <span class="at">end_month =</span> <span class="dv">12</span>, <span class="at">end_year =</span> <span class="dv">2023</span>)</span></code></pre></div>
</div>
</div>
<div id="function-defaults" class="section level2 hasAnchor" number="1.5">
<h2><span class="header-section-number">1.5</span> Function Defaults<a href="api-calls-functions-and-iterations.html#function-defaults" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Look at the code that you just wrote; writing out all of those unchanging date arguments still feels repetitive, right? When developing functions, there is an option for setting default values for arguments so that you don’t necessarily have to write all of them out every time you run it in the future. But, the option still exists within the function to make changes when necessary. For example, let’s tweak our <code>parkwide_visitaion()</code> function to have the default year be 2023:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="api-calls-functions-and-iterations.html#cb18-1" tabindex="-1"></a>parkwide_visitation <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">year =</span> <span class="st">&quot;2023&quot;</span>) {</span>
<span id="cb18-2"><a href="api-calls-functions-and-iterations.html#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="api-calls-functions-and-iterations.html#cb18-3" tabindex="-1"></a>raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(<span class="at">url =</span> <span class="fu">paste0</span>(<span class="st">&quot;https://irmaservices.nps.gov/v3/rest/stats/total/&quot;</span>, year))</span>
<span id="cb18-4"><a href="api-calls-functions-and-iterations.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="api-calls-functions-and-iterations.html#cb18-5" tabindex="-1"></a><span class="co"># convert content to text</span></span>
<span id="cb18-6"><a href="api-calls-functions-and-iterations.html#cb18-6" tabindex="-1"></a>extracted_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">content</span>(raw_data, <span class="at">as =</span> <span class="st">&quot;text&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) </span>
<span id="cb18-7"><a href="api-calls-functions-and-iterations.html#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="api-calls-functions-and-iterations.html#cb18-8" tabindex="-1"></a><span class="co"># parse text from JSON to data frame</span></span>
<span id="cb18-9"><a href="api-calls-functions-and-iterations.html#cb18-9" tabindex="-1"></a>final_data <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(extracted_data)</span>
<span id="cb18-10"><a href="api-calls-functions-and-iterations.html#cb18-10" tabindex="-1"></a></span>
<span id="cb18-11"><a href="api-calls-functions-and-iterations.html#cb18-11" tabindex="-1"></a><span class="fu">return</span>(final_data)</span>
<span id="cb18-12"><a href="api-calls-functions-and-iterations.html#cb18-12" tabindex="-1"></a></span>
<span id="cb18-13"><a href="api-calls-functions-and-iterations.html#cb18-13" tabindex="-1"></a>}</span>
<span id="cb18-14"><a href="api-calls-functions-and-iterations.html#cb18-14" tabindex="-1"></a></span>
<span id="cb18-15"><a href="api-calls-functions-and-iterations.html#cb18-15" tabindex="-1"></a><span class="fu">parkwide_visitation</span>()</span></code></pre></div>
<pre><code>##    Month NonRecreationVisitors RecreationVisitors UnitCode UnitName Year
## 1      1              13016720           13636466       NA       NA 2023
## 2      2              12518074           14895900       NA       NA 2023
## 3      3              14388294           22215789       NA       NA 2023
## 4      4              14203912           26383797       NA       NA 2023
## 5      5              14928384           31859672       NA       NA 2023
## 6      6              14942656           38753491       NA       NA 2023
## 7      7              15466721           42463634       NA       NA 2023
## 8      8              15097240           37500130       NA       NA 2023
## 9      9              14424743           32418448       NA       NA 2023
## 10    10              14890795           29636427       NA       NA 2023
## 11    11              14026785           19441371       NA       NA 2023
## 12    12              13495629           16293521       NA       NA 2023</code></pre>
<p>Because the default year is 2023, you don’t have to write it out explicitly in the function (so long as that’s the year you’re interested in). But, you still have the option of changing the year to something else:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="api-calls-functions-and-iterations.html#cb20-1" tabindex="-1"></a><span class="fu">parkwide_visitation</span>(<span class="at">year =</span> <span class="st">&quot;1992&quot;</span>)</span></code></pre></div>
<pre><code>##    Month NonRecreationVisitors RecreationVisitors UnitCode UnitName Year
## 1      1               6209285           10940618       NA       NA 1992
## 2      2               6010027           11931340       NA       NA 1992
## 3      3               6756902           15369139       NA       NA 1992
## 4      4               7255782           21458739       NA       NA 1992
## 5      5               7690763           26648530       NA       NA 1992
## 6      6               7593227           33284625       NA       NA 1992
## 7      7               8438755           41099305       NA       NA 1992
## 8      8               8056823           38625804       NA       NA 1992
## 9      9               7329755           26438266       NA       NA 1992
## 10    10               7105574           23616057       NA       NA 1992
## 11    11               6507805           14338165       NA       NA 1992
## 12    12               6702698           10943961       NA       NA 1992</code></pre>
<div id="exercise-5" class="section level3 hasAnchor" number="1.5.1" style="color: maroon">
<h3><span class="header-section-number">1.5.1</span> Exercise #5<a href="api-calls-functions-and-iterations.html#exercise-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>For our <code>unit_visitation()</code> function, make the default arguments for the start and end months January and December, respectively. This way, we are automatically pulling in data for an entire year. Then, rerun the updated <code>unit_visitation()</code> function for ROMO, EVER, and THRO for the 1980-2023 time period to make sure it works properly.</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="api-calls-functions-and-iterations.html#cb22-1" tabindex="-1"></a>unit_visitation <span class="ot">&lt;-</span> <span class="cf">function</span>(park_unit,</span>
<span id="cb22-2"><a href="api-calls-functions-and-iterations.html#cb22-2" tabindex="-1"></a>                            <span class="at">start_month =</span> <span class="dv">1</span>,</span>
<span id="cb22-3"><a href="api-calls-functions-and-iterations.html#cb22-3" tabindex="-1"></a>                            start_year,</span>
<span id="cb22-4"><a href="api-calls-functions-and-iterations.html#cb22-4" tabindex="-1"></a>                            <span class="at">end_month =</span> <span class="dv">12</span>,</span>
<span id="cb22-5"><a href="api-calls-functions-and-iterations.html#cb22-5" tabindex="-1"></a>                            end_year) {</span>
<span id="cb22-6"><a href="api-calls-functions-and-iterations.html#cb22-6" tabindex="-1"></a>  raw_data <span class="ot">&lt;-</span> httr<span class="sc">::</span><span class="fu">GET</span>(</span>
<span id="cb22-7"><a href="api-calls-functions-and-iterations.html#cb22-7" tabindex="-1"></a>    <span class="at">url =</span> <span class="fu">paste0</span>(</span>
<span id="cb22-8"><a href="api-calls-functions-and-iterations.html#cb22-8" tabindex="-1"></a>      <span class="st">&#39;https://irmaservices.nps.gov/v3/rest/stats/visitation?unitCodes=&#39;</span>,</span>
<span id="cb22-9"><a href="api-calls-functions-and-iterations.html#cb22-9" tabindex="-1"></a>      park_unit,</span>
<span id="cb22-10"><a href="api-calls-functions-and-iterations.html#cb22-10" tabindex="-1"></a>      <span class="st">&#39;&amp;startMonth=&#39;</span>,</span>
<span id="cb22-11"><a href="api-calls-functions-and-iterations.html#cb22-11" tabindex="-1"></a>      start_month,</span>
<span id="cb22-12"><a href="api-calls-functions-and-iterations.html#cb22-12" tabindex="-1"></a>      <span class="st">&#39;&amp;startYear=&#39;</span>,</span>
<span id="cb22-13"><a href="api-calls-functions-and-iterations.html#cb22-13" tabindex="-1"></a>      start_year,</span>
<span id="cb22-14"><a href="api-calls-functions-and-iterations.html#cb22-14" tabindex="-1"></a>      <span class="st">&#39;&amp;endMonth=&#39;</span>,</span>
<span id="cb22-15"><a href="api-calls-functions-and-iterations.html#cb22-15" tabindex="-1"></a>      end_month,</span>
<span id="cb22-16"><a href="api-calls-functions-and-iterations.html#cb22-16" tabindex="-1"></a>      <span class="st">&#39;&amp;endYear=&#39;</span>,</span>
<span id="cb22-17"><a href="api-calls-functions-and-iterations.html#cb22-17" tabindex="-1"></a>      end_year</span>
<span id="cb22-18"><a href="api-calls-functions-and-iterations.html#cb22-18" tabindex="-1"></a>    )</span>
<span id="cb22-19"><a href="api-calls-functions-and-iterations.html#cb22-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-20"><a href="api-calls-functions-and-iterations.html#cb22-20" tabindex="-1"></a>    httr<span class="sc">::</span><span class="fu">content</span>(<span class="at">as =</span> <span class="st">&#39;text&#39;</span>, <span class="at">encoding =</span> <span class="st">&#39;UTF-8&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-21"><a href="api-calls-functions-and-iterations.html#cb22-21" tabindex="-1"></a>    jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>()</span>
<span id="cb22-22"><a href="api-calls-functions-and-iterations.html#cb22-22" tabindex="-1"></a>}</span>
<span id="cb22-23"><a href="api-calls-functions-and-iterations.html#cb22-23" tabindex="-1"></a></span>
<span id="cb22-24"><a href="api-calls-functions-and-iterations.html#cb22-24" tabindex="-1"></a>pull_ROMO <span class="ot">&lt;-</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> <span class="st">&#39;ROMO&#39;</span>, <span class="at">start_year =</span> <span class="dv">1980</span>, <span class="at">end_year =</span> <span class="dv">2023</span>)</span>
<span id="cb22-25"><a href="api-calls-functions-and-iterations.html#cb22-25" tabindex="-1"></a>pull_EVER <span class="ot">&lt;-</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> <span class="st">&#39;EVER&#39;</span>, <span class="at">start_year =</span> <span class="dv">1980</span>, <span class="at">end_year =</span> <span class="dv">2023</span>)</span>
<span id="cb22-26"><a href="api-calls-functions-and-iterations.html#cb22-26" tabindex="-1"></a>pull_THRO <span class="ot">&lt;-</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> <span class="st">&#39;THRO&#39;</span>, <span class="at">start_year =</span> <span class="dv">1980</span>, <span class="at">end_year =</span> <span class="dv">2023</span>)</span></code></pre></div>
</div>
</div>
<div id="iterations" class="section level2 hasAnchor" number="1.6">
<h2><span class="header-section-number">1.6</span> Iterations<a href="api-calls-functions-and-iterations.html#iterations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>At this point, we now know how to develop functions so that we do not have to keep writing out redundant steps in a workflow. However, in that last exercise, you can see that we are <em>still</em> writing out redundant code; we are performing the exact same function on each of our three park units.</p>
<p>Another tool for reducing redundancy is <strong>iteration</strong>, which allows you to do the same thing on multiple inputs. Iteration can happen across different objects, different rows, different data frames, the list goes on and on!</p>
</div>
<div id="for-loops" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> For loops<a href="api-calls-functions-and-iterations.html#for-loops" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <code>for</code> loop is base R’s iteration tool that executes code across a vector, an array, a list, etc. To save the outcome of each iteration, you must first create a vector to store the outputs in that is sized based on how many objects you want to iterate over. For example, I want to run our <code>parkwide_visitation()</code> function over the last five years: 2019, 2020, 2021, 2022, and 2023. To do that, I will first need to develop a vector listing each year:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="api-calls-functions-and-iterations.html#cb23-1" tabindex="-1"></a>years <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;2019&#39;</span>, <span class="st">&#39;2020&#39;</span>, <span class="st">&#39;2021&#39;</span>, <span class="st">&#39;2022&#39;</span>, <span class="st">&#39;2023&#39;</span>)</span></code></pre></div>
<p>… and then develop an empty list to store each year’s <code>parkwide_visitation()</code> results (i.e., output) into:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="api-calls-functions-and-iterations.html#cb24-1" tabindex="-1"></a>output_floop <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(years))</span></code></pre></div>
<p>Now that we have a place to store each year’s function results, we can move forward with the <code>for</code> loop itself:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="api-calls-functions-and-iterations.html#cb25-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(years)){</span>
<span id="cb25-2"><a href="api-calls-functions-and-iterations.html#cb25-2" tabindex="-1"></a>  </span>
<span id="cb25-3"><a href="api-calls-functions-and-iterations.html#cb25-3" tabindex="-1"></a>  output_floop[[i]] <span class="ot">&lt;-</span></span>
<span id="cb25-4"><a href="api-calls-functions-and-iterations.html#cb25-4" tabindex="-1"></a>    <span class="fu">parkwide_visitation</span>(<span class="at">year =</span> years[i])</span>
<span id="cb25-5"><a href="api-calls-functions-and-iterations.html#cb25-5" tabindex="-1"></a>  </span>
<span id="cb25-6"><a href="api-calls-functions-and-iterations.html#cb25-6" tabindex="-1"></a>}</span></code></pre></div>
<p>… where <code>years[i]</code> tells the <code>for</code> loop to perform <code>parkwide_visitation()</code> on the <em>i<sup>th</sup></em> year (think of <em>i</em> as the vector position, moving across each year), and <code>output_floop[[i]]</code> directs the <code>for</code> loop to store the results of the <em>i<sup>th</sup></em> year’s run into <code>output</code>’s <em>i<sup>th</sup></em> list (think of <code>output_floop[[i]]</code> as the location in <code>output_floop</code> that the <em>i<sup>th</sup></em>’s results go).</p>
<p>We now have a list containing five data frames: one for each year of visitation data:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="api-calls-functions-and-iterations.html#cb26-1" tabindex="-1"></a><span class="fu">summary</span>(output_floop)</span></code></pre></div>
<pre><code>##      Length Class      Mode
## [1,] 6      data.frame list
## [2,] 6      data.frame list
## [3,] 6      data.frame list
## [4,] 6      data.frame list
## [5,] 6      data.frame list</code></pre>
<p>Because each year’s output is structured identically, we can confidently combine each year’s data frame into a single data frame using <code>dplyr::bind_rows()</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="api-calls-functions-and-iterations.html#cb28-1" tabindex="-1"></a>multi_years <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(output_floop)</span></code></pre></div>
<div id="exercise-6" class="section level3 hasAnchor" number="1.7.1" style="color: maroon">
<h3><span class="header-section-number">1.7.1</span> Exercise #6<a href="api-calls-functions-and-iterations.html#exercise-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Use a for loop to run <code>unit_visitation()</code> with arguments <code>start_year = 1980</code> and <code>end_year = 2021</code> across ROMO, EVER, and THRO. Then, create a single data frame containing each park units’ output. (Hint: Your first step will be to create a vector listing each park unit.)</strong></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="api-calls-functions-and-iterations.html#cb29-1" tabindex="-1"></a>park_units <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;ROMO&#39;</span>, <span class="st">&#39;EVER&#39;</span>, <span class="st">&#39;THRO&#39;</span>)</span>
<span id="cb29-2"><a href="api-calls-functions-and-iterations.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="api-calls-functions-and-iterations.html#cb29-3" tabindex="-1"></a>new_output_floop <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="at">length =</span> <span class="fu">length</span>(park_units))</span>
<span id="cb29-4"><a href="api-calls-functions-and-iterations.html#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="api-calls-functions-and-iterations.html#cb29-5" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(park_units)){</span>
<span id="cb29-6"><a href="api-calls-functions-and-iterations.html#cb29-6" tabindex="-1"></a>  </span>
<span id="cb29-7"><a href="api-calls-functions-and-iterations.html#cb29-7" tabindex="-1"></a>  new_output_floop[[i]] <span class="ot">&lt;-</span></span>
<span id="cb29-8"><a href="api-calls-functions-and-iterations.html#cb29-8" tabindex="-1"></a>    <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> park_units[i],</span>
<span id="cb29-9"><a href="api-calls-functions-and-iterations.html#cb29-9" tabindex="-1"></a>                    <span class="at">start_year =</span> <span class="dv">1980</span>,</span>
<span id="cb29-10"><a href="api-calls-functions-and-iterations.html#cb29-10" tabindex="-1"></a>                    <span class="at">end_year =</span> <span class="dv">2021</span>)</span>
<span id="cb29-11"><a href="api-calls-functions-and-iterations.html#cb29-11" tabindex="-1"></a>  </span>
<span id="cb29-12"><a href="api-calls-functions-and-iterations.html#cb29-12" tabindex="-1"></a>}</span>
<span id="cb29-13"><a href="api-calls-functions-and-iterations.html#cb29-13" tabindex="-1"></a></span>
<span id="cb29-14"><a href="api-calls-functions-and-iterations.html#cb29-14" tabindex="-1"></a>multi_park_units <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(new_output_floop)</span></code></pre></div>
</div>
</div>
<div id="mapping" class="section level2 hasAnchor" number="1.8">
<h2><span class="header-section-number">1.8</span> Mapping<a href="api-calls-functions-and-iterations.html#mapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The {tidyverse}’s {purrr} package has its own iteration function, <code>map()</code>, that is a variation of the <code>for</code> loop. <code>map()</code> takes a vector and applies a single function across it, then automatically stores all of the results into a list. In other words, <code>map()</code> creates an appropriately sized list to store our results in for us. This eliminates the need to create an empty list ahead of time.</p>
<p>To create the same output as our previous <code>for</code> loop on <code>parkwide_visitation()</code>, but using <code>map()</code> instead, we would run the following code:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="api-calls-functions-and-iterations.html#cb30-1" tabindex="-1"></a>output_map <span class="ot">&lt;-</span> years <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="api-calls-functions-and-iterations.html#cb30-2" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">parkwide_visitation</span>(<span class="at">year =</span> .x))</span></code></pre></div>
<p>… where <code>~</code> indicates that we want to perform <code>parkwide_visitation()</code> across all years, and <code>.x</code> indicates that we want to use our piped vector, <code>years</code>, as the input to the <code>year</code> argument. As you can see, <code>output_map</code> is identical to <code>output_floop</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="api-calls-functions-and-iterations.html#cb31-1" tabindex="-1"></a><span class="fu">identical</span>(output_floop, output_map)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>… which means we can also <code>bind_rows()</code> to get the mapped output into a single data frame:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="api-calls-functions-and-iterations.html#cb33-1" tabindex="-1"></a>multi_years <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(output_map)</span></code></pre></div>
<div id="exercise-7" class="section level3 hasAnchor" number="1.8.1" style="color: maroon">
<h3><span class="header-section-number">1.8.1</span> Exercise #7<a href="api-calls-functions-and-iterations.html#exercise-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Use <code>map()</code> to run <code>unit_visitation()</code> with arguments <code>start_year = 1980</code> and <code>end_year = 2021</code> across ROMO, EVER, and THRO. Then, create a single data frame containing each park units’ output.</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="api-calls-functions-and-iterations.html#cb34-1" tabindex="-1"></a>new_output_map <span class="ot">&lt;-</span> park_units <span class="sc">%&gt;%</span> </span>
<span id="cb34-2"><a href="api-calls-functions-and-iterations.html#cb34-2" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span> <span class="fu">unit_visitation</span>(<span class="at">park_unit =</span> .x, <span class="at">start_year =</span> <span class="dv">1980</span>, <span class="at">end_year =</span> <span class="dv">2021</span>))</span>
<span id="cb34-3"><a href="api-calls-functions-and-iterations.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="api-calls-functions-and-iterations.html#cb34-4" tabindex="-1"></a><span class="fu">identical</span>(new_output_floop, new_output_map)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="api-calls-functions-and-iterations.html#cb36-1" tabindex="-1"></a>new_multi_park_units <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(new_output_map)</span>
<span id="cb36-2"><a href="api-calls-functions-and-iterations.html#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="api-calls-functions-and-iterations.html#cb36-3" tabindex="-1"></a><span class="fu">identical</span>(new_multi_park_units, multi_park_units)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-wrangling-and-visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
